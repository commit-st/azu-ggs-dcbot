import random
import discord
from discord.ext import commands
from discord import app_commands
from discord.utils import escape_markdown as esc  # êµµê²Œ ì²˜ë¦¬ ì‹œ ë§ˆí¬ë‹¤ìš´ ì´ìŠ¤ì¼€ì´í”„

class MenuRecommend(commands.Cog):
    def __init__(self, bot: commands.Bot):
        self.bot = bot
        self.fortunes = [
            "í”¼ì", "ë¡œì œë–¡ë³¶ì´", "í† ë§ˆí† íŒŒìŠ¤íƒ€", "ì§œì¥ë©´", "í¬ë¦¼ìš°ë™", "ë¶ˆë‹­ë³¶ìŒë©´", "ë‹­ê°ˆë¹„", "ì œìœ¡ë³¶ìŒ", "ë‹­ë³¶ìŒíƒ•", "í›„í† ë§ˆë¼", "ì¹˜ì¦ˆê·¸ë¼íƒ•",
            "ê³ êµ¬ë§ˆì¹˜ì¦ˆëˆê¹ŒìŠ¤", "ê²½ì–‘ì‹ëˆê¹ŒìŠ¤ì™€ ìŠ¤í”„", "ì•ˆì‹¬/ë“±ì‹¬ ëˆê¹ŒìŠ¤", "íƒ€ì½”ì•¼ë¼", "ê¹Œë¥´ë³´ë¶ˆë‹­", "ê³„ë€ì´ˆë°¥", "ì¥ìƒˆìš°ì´ˆë°¥", "ì°¸ì¹˜ë§ˆìš”", "ì¹˜í‚¨ë§ˆìš”",
            "ë³¶ìŒìš°ë™", "ì°¨ëŒì§¬ë½•", "ë¼ë©´", "ì—½ë–¡", "í¬ë¦¬ìŠ¤í”¼ë„ë„›", "ì„œë¸Œì›¨ì´ B.L.T", "í‚¤í† ê¹€ë°¥", "í¬ì¼€", "ëˆì½”ì¸ ë¼ë©˜", "ì¹˜ì¦ˆê¹€ë°¥", "ìˆœë‘ë¶€ì—´ë¼ë©´",
            "ì—ê·¸ë§ˆìš” ìƒŒë“œìœ„ì¹˜", "ê¹€ì¹˜ì°Œê°œ", "ë¡œì œì°œë‹­", "ì°¸ì¹˜ê¹€ë°¥", "ë§ˆë¼ìƒ¹ê¶ˆ", "ë§ˆë¼íƒ•", "ì•¼í‚¤ë‹ˆì¿ ", "ë°”ì§ˆí† ë§ˆí† ì—ì´ë“œì™€ ì ë´‰ëµˆë¥´ ìƒŒë“œìœ„ì¹˜",
            "ë¹„ë¹”ë°¥", "ë‘ë¶€ê¹€ì¹˜", "ì—°ì–´ì´ˆë°¥", "ëˆë¶€ë¦¬", "ìš°ì‚¼ê²¹ë®ë°¥", "ëœì¥ì°Œê°œ", "ê·œì¹´ì¸ ", "ë©”ë°€ì†Œë°”",
            "ìƒ¤ë¸Œìƒ¤ë¸Œ", "ìŠ¤í…Œì´í¬", "ì¹˜ì¦ˆë²„ê±°", "í›„ë¼ì´ë“œì¹˜í‚¨", "íŒŸíƒ€ì´", "í•¨ë°• ìŠ¤í…Œì´í¬", "í–„ë²„ê±°", "ë§ˆíŒŒë‘ë¶€", "ê³ ì¶”ì¡ì±„",
            "ë‚˜ì‹œê³ ë­", "ë¶€ë¦¬ë˜", "ë–¡ë³¶ì´ì— íŠ€ê¹€", "í•„ë¼í”„", "ì¹´ë ˆ", "ê¹€ì¹˜ë³¶ìŒë°¥", "ìˆœë‘ë¶€ì°Œê°œ", "ë¶€ëŒ€ì°Œê°œ", "ê°ˆë¹„íƒ•", "ë¹„ë¹”ë°¥",
            "í”¼ì‰¬ì•¤ì¹©ìŠ¤", "ë¦¬ì¡°ë˜", "í¬ë¡œí¬ë¬´ìŠˆ", "í´ëŸ½ìƒŒë“œìœ„ì¹˜", "íŒŒë‹ˆë‹ˆ", "ìƒì„ êµ¬ì´", "ì˜¤ì§•ì–´/ë‚™ì§€ë³¶ìŒ", "ì–‘ë…/ê°„ì¥ê²Œì¥",
            "íƒ€ì½”", "ë¼ˆí•´ì¥êµ­", "ê°ìíƒ•", "ëƒ‰ë©´ì— ê³ ê¸°", "ì‹œë¦¬ì–¼", "ìˆ˜ì œë¹„", "ìŒ€êµ­ìˆ˜", "ì”ì¹˜êµ­ìˆ˜", "ê°ì ìƒëŸ¬ë“œ", "í† ë§ˆí† ë‹¬ê±€ë³¶ìŒ",
            "ì—°ì–´ ìƒëŸ¬ë“œ", "ë‚™ì§€ê¹€ì¹˜ì£½", "ì‡ ê³ ê¸°ì•¼ì±„ì£½", "í˜¸ë°•ì£½", "ì‚¼ê²¹ì‚´ êµ¬ì´", "í•´ë¬¼ì§¬ë½•", "ì˜¤ë¯€ë¼ì´ìŠ¤", "ê°„ì¥ê³„ë€ë°¥", "ì˜¤ì°¨ì¦ˆì¼€",
            "ê°ë°”ìŠ¤", "ë§ˆì œì†Œë°”", "ê°ˆë¹„ë§Œë‘", "ê³ ê¸°ë§Œë‘", "ë³´ìŒˆ/ì¡±ë°œ", "êµì´Œ í—ˆë‹ˆì½¤ë³´", "êµ½ë„¤ ê³ ì¶”ë°”ì‚¬ì‚­", "BHC ë¿Œë§í´", "ì§€ì½”ë°”ë¡œ ì¹˜ë°¥", "BBQ í™©ê¸ˆì˜¬ë¦¬ë¸Œ",
            "ê³±ì°½/ëŒ€ì°½/ë§‰ì°½", "KFC", "ì§œíŒŒêµ¬ë¦¬", "ì§œê³„ì¹˜", "ë„ˆêµ¬ë¦¬ ë¼ë©´", "ì˜¤ê¼¬ë…¸ë¯¸ì•¼ë¼", "ì˜¤ì•¼ê¼¬ë™", "ê¿”ë°”ë¡œìš°", "ìº˜ë¦¬í¬ë‹ˆì•„ë¡¤",
            "ë¼ìëƒ", "íˆ¬ì›€ë°” íŒŒìŠ¤íƒ€", "ì „ë³µì£½", "í›ˆì œì˜¤ë¦¬", "í”„ë¦¬íƒ€íƒ€", "ë–¡ë§Œë‘£êµ­", "ì˜¤ë…íƒ•", "ë‹­ë°œ", "ê°€ì¸ ë™", "íšŒ", "íšŒë®ë°¥",
            "ìœ¡íšŒë¹„ë¹”ë°¥", "ë¹„ë¹”êµ­ìˆ˜", "ì¹¼êµ­ìˆ˜", "ìƒˆìš°ë³¶ìŒë°¥", "ì½©êµ­ìˆ˜", "ì „/ë¶€ì¹¨ê°œ", "ìˆœëŒ€ë³¶ìŒ", "ì§œì¥ë°¥", "ì†Œì‹œì§€ì•¼ì±„ë³¶ìŒ", "ê·¸ë¦­ ìš”ê±°íŠ¸",
            "ì¡ì±„", "ìƒ¤ì˜¤ë¡±ë°”ì˜¤", "ì‚¬ì‹œë¯¸", "ê°„ì¥ì°œë‹­", "ìŠ¤í‚¤ì•¼í‚¤", "ê³„ë€ë§ì´", "í•´ë¬¼ì°œ", "í•´ë¬¼íƒ•", "ì¡°ê°œêµ¬ì´", "ë°€í‘€ìœ ë‚˜ë² ", "ì–‘ê¼¬ì¹˜",
            "ë§¥ì•¤ì¹˜ì¦ˆ", "ë¿ŒíŒŸíì»¤ë¦¬", "ë¶„ì§œ", "ëª©ì‚´ê¹€ì¹˜ì°œ", "ê³„ë€í›„ë¼ì´", "ë‹­ê°€ìŠ´ì‚´+ê³ êµ¬ë§ˆ+ì•¼ì±„", "ì½©ë‚˜ë¬¼êµ­ë°¥", "í¬ì¼“ëª¬ë¹µì´ë‘ ìš°ìœ ", "ì‚¼ê°ê¹€ë°¥", "ì»µëˆ„ë“¤",
            "ê³¤ì•½êµ­ìˆ˜", "ì»µë°¥", "ë°¥ë²„ê±°", "ë…¸ë‘í†µë‹­ ì•Œë§ˆì¹˜", "ì—´ë¬´êµ­ìˆ˜", "ì—´ë¬´ë¹„ë¹”ë°¥", "êµ´ë°¥", "ì¡°ê°œíƒ•", "ë¬¼", "ìƒì˜¤ì´/ë‹¹ê·¼ì— ì¥ ì°ì–´ë¨¹ê¸°",
        ]

    def _menu_message(self, user_mention: str, choice: str) -> str:
        return f"ğŸ˜‹ {user_mention}ë‹˜ì„ ìœ„í•œ ë©”ë‰´ ì¶”ì²œ! **{esc(choice)}** ì–´ë– ì„¸ìš”? ë§›ìˆê²Œ ë“œì„¸ìš”!ğŸ½ï¸"

    @commands.command(name="ë©”ì¶”")
    async def fortune_prefix(self, ctx: commands.Context):
        choice = random.choice(self.fortunes)
        await ctx.send(self._menu_message(ctx.author.mention, choice))

    @app_commands.command(name="menu", description="ë©”ë‰´ë¥¼ ì¶”ì²œí•´ë“œë ¤ìš”!")
    async def fortune_slash(self, interaction: discord.Interaction):
        choice = random.choice(self.fortunes)
        await interaction.response.send_message(self._menu_message(interaction.user.mention, choice))

# í•œêµ­ì–´ ë¡œì»¬ë¼ì´ì§•: /menu â†’ /ë©”ì¶” ë¡œ ë³´ì´ê²Œ
class SimpleKoTranslator(app_commands.Translator):
    async def translate(self, string: app_commands.locale_str, locale: discord.Locale, context: app_commands.TranslationContext):
        if locale is discord.Locale.korean:
            table = {"menu": "ë©”ì¶”", "ë©”ë‰´ë¥¼ ì¶”ì²œí•´ë“œë ¤ìš”!": "ë©”ë‰´ë¥¼ ì¶”ì²œí•´ë“œë ¤ìš”!"}
            return table.get(str(string))
        return None

async def setup(bot: commands.Bot):
    try:
        await bot.tree.set_translator(SimpleKoTranslator())
    except Exception:
        pass
    await bot.add_cog(MenuRecommend(bot))
